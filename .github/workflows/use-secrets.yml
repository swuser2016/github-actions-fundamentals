name: Using Secrets Safely

on:
  workflow_dispatch:

jobs:
  demonstrate-secrets:
    runs-on: ubuntu-latest
    
    steps:
      - name: ❌ WRONG - Printing secret directly
        run: |
          echo "This is WRONG and will be redacted:"
          echo "API Key: ${{ secrets.API_KEY }}"
          echo "Password: ${{ secrets.DATABASE_PASSWORD }}"
      
      - name: ✅ CORRECT - Using secret in commands
        run: |
          echo "Connecting to database..."
          # In real scenario: mysql -u admin -p"${{ secrets.DATABASE_PASSWORD }}" -h db.example.com
          echo "Database connection successful (password used but not shown)"
      
      - name: ✅ CORRECT - Using secret as environment variable
        env:
          API_KEY: ${{ secrets.API_KEY }}
          DEPLOY_TOKEN: ${{ secrets.DEPLOY_TOKEN }}
        run: |
          echo "Making API call with authentication..."
          # In real scenario: curl -H "Authorization: Bearer $API_KEY" https://api.example.com
          echo "API call successful"
          
          echo "Deploying with token..."
          # In real scenario: deploy-cli --token "$DEPLOY_TOKEN" deploy
          echo "Deployment initiated"
      
      - name: ✅ CORRECT - Passing secrets to actions
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}  # Built-in secret
      
      - name: Check secret availability
        run: |
          if [ -z "${{ secrets.API_KEY }}" ]; then
            echo "❌ API_KEY secret not found"
            exit 1
          else
            echo "✅ API_KEY secret is available"
          fi
